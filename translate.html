<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <title>translate</title>
   <style media="screen">
      .box{
         position: fixed;
         left: 0;
         right: 0;
         top: 0;
         bottom: 0;
         margin: auto;
      }
   </style>
   <script type="text/javascript">
      function log(...arg) {
         console.log(...arg)
      }
      function select(sel) {
         return document.querySelector(sel)
      }
      window.onload = function() {
         var canvas = elementFull(setElement(select(".box"),createCanvas()))

         var center = {
            x:canvas.width/2,
            y:canvas.height/2,
         }

         var energy = [
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
            rand(100, 200),
         ]

         var numberOfEnergy = energy.length
         var energyRotate = 360 / numberOfEnergy

         ctxTrans(canvas, center.x, center.y)
         drawPoint(canvas, 0, 0, 3, "red")

         //begin
         //绘制超级nb 的东西
         getContext(canvas).moveTo(
            Math.cos(energyRotate * 0 / 180 * Math.PI) * energy[0],
            Math.sin(energyRotate * 0 / 180 * Math.PI) * energy[0]
         )
         for(var index = 0; index < energy.length; index ++) {
            var angle = energyRotate * index / 180 * Math.PI
            var w = 20
            var x = Math.cos(angle) * energy[index]
            var y = Math.sin(angle) * energy[index]

            var d1x = x
            var d1y = y

            var d2x = x - Math.sin(angle) * w
            var d2y = y + Math.cos(angle) * w

            i = (index + 1) % energy.length
            var angle = energyRotate * (i) / 180 * Math.PI
            var d4x = Math.cos(angle) * energy[i]
            var d4y = Math.sin(angle) * energy[i]

            var d3x = d4x + Math.sin(angle) * w
            var d3y = d4y - Math.cos(angle) * w

            curveOfPath(canvas, [
               {x:d2x, y:d2y},
               {x:d3x, y:d3y},
               {x:d4x, y:d4y},
            ])
         }
         fill(canvas, "skyblue")
         //end
      }

      //base
      function rand(min, max) {
         return Math.floor(min + Math.random() * (max - min + 1))
      }

      //element
      function setElement(place, element) {
         place.append(element)
         return element
      }
      function getParentWidth(element) {
         return element.parentElement.offsetWidth
      }
      function getParentHeight(element) {
         return element.parentElement.offsetHeight
      }
      function setElementHeight(element, height) {
         element.style.height = height + "px"
         element.height = height
         return element
      }
      function setElementWidth(element, width) {
         element.style.width = width + "px"
         element.width = width
         return element
      }
      function elementFull(element) {
         setElementWidth(element, getParentWidth(element))
         setElementHeight(element, getParentHeight(element))
         return element
      }

      //canvas
      function createCanvas() {
         return document.createElement("canvas")
      }
      function getContext(canvas) {
         return canvas.getContext("2d")
      }
      function fill(canvas, style) {
         var ctx = getContext(canvas)
         ctx.fillStyle = style
         ctx.fill()
      }
      function stroke(canvas, style) {
         var ctx = getContext(canvas)
         ctx.strokeStyle = style
         ctx.stroke()
      }
      function drawPoint(canvas, x, y, r = 2, color = "black") {
         var ctx = getContext(canvas)
         ctx.beginPath()
         ctx.arc(x, y, r, 0, Math.PI * 2)
         ctx.fillStyle = color
         ctx.fill()
         return canvas
      }
      function drawPoints(canvas, points) {
         points.forEach(function(item) {
            drawPoint(canvas, item.x, item.y, item.r, item.color)
         })
         return canvas
      }
      function curveOfPath(canvas, dots = []) {
         if(dots.length != 3) {
            log("the length of dots aren't three in " + (curveOfPath.caller ? curveOfPath.caller : curveOfPath.name))
         }else {
            var ctx = getContext(canvas)
            ctx.bezierCurveTo(dots[0].x, dots[0].y, dots[1].x, dots[1].y, dots[2].x, dots[2].y)
         }
         return canvas
      }
      function ctxTrans(canvas, x, y) {
         getContext(canvas).translate(x,y)
      }
      function ctxRotate(canvas, angle) {
         getContext(canvas).rotate(angle)
      }
      function ctxSave(canvas) {
         getContext(canvas).save()
      }
      function ctxRestore(canvas) {
         getContext(canvas).restore()
      }
      function ctxClosePath(canvas) {
         getContext(canvas).closePath()
      }
   </script>
</head>
<body>
   <div class="box">

   </div>
</body>
</html>
