<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <script src="vue.js"></script>
   <title>Document</title>
</head>
<body>
    <div id="p-list">
        <project-list></project-list>
    </div>
    <script>
        let list = Vue.component("project-list", {
            template: "<ul><li v-for='item in list' v-on='goto(item)'>{{item}}</li></ul>",
            data: function(){
                return {
                    list: null,
                }
            },
            created: function() {
                let p = this.getList();
                p.then((text) => {
                    this.list = JSON.parse(text);
                }).catch((text) => {
                    this.list = [];
                })
            },
            methods: {
                getList() {
                    return new Promise(function (resolve, reject) {
                        let xhr = new XMLHttpRequest();
                        xhr.open("POST", "./libertyProject/returnProjectList.php")
                        xhr.onload = () => {resolve(xhr.responseText)}
                        xhr.onerror = () => {reject(xhr.statusText)}
                        xhr.send()
                    })
                },
                goto(href) {
                    window.location.href = window.location.pathname + "/libertyProject/" + href;
                },
            }
        })
        let pList = new Vue({el:"#p-list"})
        </script>
</body>
</html>
