<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <title>树可视化</title>
   <style>
      *{
         margin: 0;
         padding: 0;
      }
      canvas{
         display: block;
      }
   </style>
</head>
<body>
   <canvas id="canvas" width="300" height="300">fuck</canvas>
   <script type="text/javascript" src="../js/Utils.js"></script>
   <script type="text/javascript" src="../dp/partical.js"></script>
   <script type="text/javascript">
      utils()

      const cvs = e("#canvas");
      const ctx = cvs.getContext("2d");

      window.full(cvs)

      let origin = {
         x: cvs.width / 2,
         y: 10,
      }
      let node = {
         margin: 50,
      }

      let tree = {
         one: {
            asdf: "dfsadf",
            a:"a",
            b:"b",
            c:"c",
            d:"d",
         },
         tow: {
            asdf: "sadf",
         },
         v: "sadf",
         n: null,
         a: function() {},
         b: function() {},
         c: function() {},
         d: function() {},
         e: function() {},
      }

      var active = {
         x:cvs.center.x,
         y:100,
      }
      var p = CreatePartical(active.x, active.y, cvs);
      traverse(tree, active.x, active.y);

      function traverse(tree, x, y, depth = 1) {
         var nodeQueue = new Array();
         var nodeCount = 0;
         var nodeObject = new Array();

         /*
         *   遍历子节点
         */
         for(var i in tree) {
            nodeCount++;
            nodeQueue.push(i);
            if( (tree[i] !== null) && (typeof tree[i] == "object") ) {
               nodeObject.push(i);
            }
         }

         // log(nodeQueue + "\n", nodeCount + "\n", nodeObject);

         var index = Math.floor(nodeCount / 2)
         if(nodeCount % 2) {
            var lx = x
            var rx = x
            var h = depth * node.margin * 2
            CreatePartical(x, active.y + h, cvs)
            for(var i = index - 1; i >= 0; i--) {
               CreatePartical(lx -= node.margin * 2, active.y + h, cvs)
               CreatePartical(rx += node.margin * 2, active.y + h, cvs)
            }
         }else {
            for(var i = index; i >= 0; i--) {
               CreatePartical(lx -= node.margin * 2, active.y + h, cvs)
               CreatePartical(rx += node.margin * 2, active.y + h, cvs)
            }
         }

         nodeObject.forEach(function(item){
            traverse(item, x, y, ++depth)
         })
      }
   </script>
</body>
</html>
