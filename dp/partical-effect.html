<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <title>Document</title>
   <script src="utils.js"></script>
   <script src="drag.js"></script>
   <script src="partical.js"></script>
   <style media="screen">
      *{
         margin: 0;
         padding: 0;
      }
      html,body{
         height: 100%;
         overflow: hidden;
      }
      .paddle{
         width: 200px;
         height: 100px;
         background: linear-gradient(to left, rgba(248,228,78,0.5), rgba(240,66,53,0.5));
         font-size: 30px;
         line-height: 100px;
         text-align: center;
      }
      .box{
         width: 500px;
         height: 500px;
         position: fixed;
         left: 0;
         bottom: 0;
         right: 0;
         top: 0;
         margin: auto;
         background-color: skyblue;
      }
      .drag{
         position: absolute!important;
         left: 0;
         top: 0;
         /*margin 必须是0*/
         margin: 0!important;
         -moz-user-select: none;
         user-select: none;
      }
      .drag:hover{
         cursor: grab;
         cursor: -webkit-grab;
      }
      #forefront{
         display: block;
         pointer-events: none;
      }
   </style>
</head>
<body>
   <canvas id="forefront" width="300" height="300"></canvas>
   <canvas class="friablePaddle drag" width="200" height="200"></canvas>
   <!-- <div class="box drag">
      <div class="paddle drag">拖拽</div>
   </div> -->
   <script type="text/javascript">

      webInit()

      //canvas 毁天灭地
      var cvs = e("#forefront")
      //动画开始
      var animation = Animation(cvs)
      //canvas 永远沾满屏幕
      fullWindow(cvs)
      window.addEventListener("resize", function() {
         fullWindow(cvs)
      })

      //填充画布内容
      es(".friablePaddle").forEach(function(item) {
         var ctx = item.getContext("2d")
         var grd = ctx.createLinearGradient(0, 0, item.width, 0)
         var text = "托拽"
         grd.addColorStop(0, "rgba(240,66,53,0.5)")
         grd.addColorStop(1, "rgba(248,228,78,0.5)")
         ctx.fillStyle = grd
         ctx.fillRect(0,0, item.width, item.height)
         ctx.font = "30px Microsoft YaHe"
         ctx.fillStyle = "black"
         ctx.textBaseline = "middle"
         var textWidth = ctx.measureText(text).width
         ctx.fillText(text, (item.width / 2) - (textWidth / 2), item.height / 2)
      })

      //所有class名中 包含drag类名的html元素 都能拖拽
      drag(function(ele, x, y) {
         if(ele.classList.contains("friablePaddle")) {
            let size = 5
            let i = 1
            let j = 1
      
            if(x < 0) {
               x = 0
            }else if(x > window.innerWidth - ele.offsetWidth) {
               x = window.innerWidth
            }else {

            }
            for(i=1; i<=ele.offsetHeight; i++) {
               let p = CreatePartical(x, y+i)
               p.init(rand(-500, 500) / 100, rand(8,10), size)
               animation.addElement(p)
            }
            // log(animation.element)
         }
      })
   </script>
</body>
</html>
